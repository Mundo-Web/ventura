import{R as a,r as s}from"./FilterItem-TykbAVkI.js";import{c as D}from"./ReactAppend-aZwGg0Ed.js";import{C as H}from"./CreateReactScript-1C7acQKr.js";import{F as L,P as O,a as U}from"./ProductCard-zqvWZ_B1.js";import"./SelectAPIFormGroup-9tOl0_JA.js";import{a as J}from"./arrayJoin-IJqKA4e3.js";import{a as b}from"./axios-_sX4vCAy.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./index-Y7t1yPR6.js";import"./CreateReactScript--cj46Hwk.js";import"./warning-8ekefGe0.js";import"./FilterContainer-wHehw30U.js";import"./TippyButton-eDjA3rCW.js";const W=({minPrice:m,maxPrice:g,categories:h,tags:P,attribute_values:F,id_cat:u,tag_id:C,subCatId:_,textoshome:c,distritosfiltro:j,limite:k})=>{const[R,S]=s.useState([]),[t,n]=s.useState({}),[d,T]=s.useState(0),[o,w]=s.useState(1),[z,q]=s.useState(!1),y=s.useRef(!1),p=s.useRef(null),f=new URLSearchParams(window.location.search),I=f.get("fecha_llegada"),B=f.get("fecha_salida"),x=f.get("lugar"),E=f.get("cantidad_personas");s.useEffect(()=>{const i=document.createElement("script");return i.src="js/notify.extend.min.js",i.async=!0,document.body.appendChild(i),()=>{document.body.removeChild(i)}},[]),s.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("tag");e&&n(r=>({...r,"txp.tag_id":[e]})),x&&n(r=>({...r,distrito_id:[x]})),E&&n(r=>({...r,precioservicio:[E]})),u&&n(r=>({...r,category_id:[u]}))},[u]),s.useEffect(()=>{w(1),v()},[t]),s.useEffect(()=>{v()},[o]),s.useEffect(()=>{_!==null&&n({...t,subcategory_id:[_]})},[]);const v=async()=>{p.current&&p.current.cancel("Operation canceled due to new request."),p.current=b.CancelToken.source();const i=[];if((t.maxPrice||t.minPrice)&&(t.maxPrice&&t.minPrice?i.push([[["precio",">=",t.minPrice],"or",[["descuento",">=",t.minPrice],"and",["descuento","<>",0]]],"and",[["precio","<=",t.maxPrice],"or",[["descuento","<=",t.maxPrice],"and",["descuento","<>",0]]]]):t.minPrice?i.push([["precio",">=",t.minPrice],"or",[["descuento",">=",t.minPrice],"and",["descuento","<>",0]]]):t.maxPrice&&i.push([["precio","<=",t.maxPrice],"or",[["descuento","<=",t.maxPrice],"and",["descuento","<>",0]]])),t["txp.tag_id"]&&t["txp.tag_id"].length>0){const e=[];t["txp.tag_id"].forEach((r,l)=>{l===0?e.push(["txp.tag_id","=",r]):e.push("or",["txp.tag_id","=",r])}),i.push(e)}if(t.distrito_id&&t.distrito_id.length>0){const e=[];t.distrito_id.forEach((r,l)=>{l===0?e.push(["distrito_id","=",r]):e.push("or",["distrito_id","=",r])}),i.push(e)}if(t.precioservicio&&t.precioservicio.length>0){const e=[];t.precioservicio.forEach((r,l)=>{l===0?e.push(["precioservicio","=",r]):e.push("or",["precioservicio","=",r])}),i.push(e)}for(const e in t){if(!e.startsWith("attribute-")||t[e].length===0)continue;const[,r]=e.split("-"),l=[];t[e].forEach((N,A)=>{A===0?l.push(["apv.attribute_value_id","=",N]):l.push("or",["apv.attribute_value_id","=",N])}),i.push([["a.id","=",r],"and",l])}if(t.category_id&&t.category_id.length>0){const e=[];t.category_id.forEach((r,l)=>{l===0?e.push(["categoria_id","=",r]):e.push("or",["categoria_id","=",r])}),i.push(e)}if(t.subcategory_id&&t.subcategory_id.length>0){const e=[];t.subcategory_id.forEach((r,l)=>{l===0?e.push(["subcategory_id","=",r]):e.push("or",["subcategory_id","=",r])}),i.push(e)}try{const{status:e,data:r}=await b.post("/api/products/paginate",{requireTotalCount:!0,filter:J([...i,["products.visible","=",!0]],"and"),take:12,skip:12*(o-1)},{headers:{"Content-Type":"application/json"},cancelToken:p.current.token});y.current=(r==null?void 0:r.is_proveedor)??!1,S((r==null?void 0:r.data)??[]),T((r==null?void 0:r.totalCount)??0)}catch(e){b.isCancel(e)?console.log("Request canceled",e.message):console.error(e)}},M=F.reduce((i,e)=>(i[e.attribute_id]||(i[e.attribute_id]=[]),i[e.attribute_id].push(e),i),{});return h.find(i=>i.id===Number(u)),a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement("section",{className:"flex flex-col lg:flex-row gap-3 lg:gap-10 justify-center items-center px-[5%] lg:pl-[5%] lg:pr-0 bg-[#5BE3A4]"},a.createElement("div",{className:"w-full lg:w-[55%] text-[#151515] flex flex-col justify-center items-center gap-2 md:gap-10"},a.createElement("div",{className:"w-full flex flex-col gap-5 px-0 lg:pr-[5%] pt-8 lg:pt-0 xl:max-w-4xl"},a.createElement("h1",{className:"text-[#F8FCFF] font-Homie_Bold text-5xl"},(c==null?void 0:c.title1section)||"Propiedades que inspiran, experiencias que marcan la diferencia.")),a.createElement("div",{class:"w-full flex flex-col gap-5 px-0 lg:pr-[5%] pt-8 md:pt-0 relative"},a.createElement(L,{setFilter:n,filter:t,minPrice:m??0,maxPrice:g??0,categories:h,tags:P,attribute_values:Object.values(M),selected_category:u,tag_id:C,distritosfiltro:j,limite:k,lugar:x,cantidad:E,llegada:I,salida:B}))),a.createElement("div",{className:"w-full lg:w-[45%] "},a.createElement("div",{className:"w-full h-full flex flex-row items-center justify-center"},a.createElement("img",{src:"images/img/portadacatalogo.png",className:"h-[200px] lg:min-h-[400px] object-contain xl:h-full object-bottom"})))),a.createElement("form",{className:"flex flex-col lg:flex-row gap-6 w-full px-[5%] lg:px-[8%]"},a.createElement("section",{className:"flex flex-col gap-6 md:basis-full py-6"},a.createElement("div",{className:"w-full bg-white rounded-lg font-medium flex flex-row justify-between items-center px-2 py-3"},a.createElement("div",{className:"flex flex-col xl:flex-row  justify-start xl:justify-between items-start gap-2 "},a.createElement("span",{className:"font-normal text-[17px] text-[#666666] xl:ml-3"},"Mostrando ",(o-1)*12+1," - ",o*12>d?d:o*12," de ",d," resultados"),a.createElement("button",{type:"button",className:"lg:hidden text-[#006BF6]",onClick:()=>q(!0)}," Mostrar Filtros"))),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 lg:gap-8"},R.map((i,e)=>a.createElement(O,{key:`product-${i.id}`,item:i,bgcolor:"bg-white",is_reseller:y.current}))),a.createElement("div",{className:"w-full font-medium flex flex-row justify-center items-center"},a.createElement(U,{current:o,setCurrent:w,pages:Math.ceil(d/12)})))),a.createElement("section",{className:"flex flex-col justify-center items-center px-[5%] xl:px-[8%] py-14 w-full bg-[#73F7AD] mt-8 lg:mt-16"},a.createElement("div",{className:"flex flex-col max-w-xl"},a.createElement("div",{className:"flex flex-col w-full text-center gap-5 text-[#006258]"},a.createElement("h2",{className:"text-4xl font-Homie_Bold"},(c==null?void 0:c.title5section)||"Ingrese un texto"),a.createElement("p",{className:"text-base font-FixelText_Regular text-[#000929]"},(c==null?void 0:c.description5section)||"Ingrese un texto")),a.createElement("div",{className:"flex flex-col mt-8 w-full gap-4"},a.createElement("div",{className:"flex flex-col w-full rounded-lg"},a.createElement("form",{id:"subsEmail",className:"flex flex-row gap-5 justify-end px-5 py-3.5 w-full bg-white rounded-2xl"},a.createElement("input",{type:"hidden",name:"tipo",value:"Catalogo"}),a.createElement("input",{placeholder:"Introduce tu correo electrónico",type:"email",id:"email",name:"email",class:"w-full px-4 py-2 text-sm font-FixelText_Regular focus:border-0 focus:ring-0 text-[#006258] placeholder:text-[#00625852] border border-transparent rounded-xl","aria-label":"Introduce tu correo electrónico",required:!0}),a.createElement("button",{type:"submit",className:"self-end px-10 py-3 text-base font-FixelText_Semibold text-center text-[#73F7AD] bg-[#009A84] rounded-lg"},"Enviar"))),a.createElement("p",{class:"text-base text-center font-FixelText_Regular text-[#000929]"},(c==null?void 0:c.footer5section)||"Ingrese un texto"))))))};H((m,g)=>{D(m).render(a.createElement(W,{...g}))});
